# huffman_coding
ソフトウェア2(2022/01/13)

ハフマン符号を出力するコードをいくつかの関数に分割して作成しました。以下では自身で作成/変更した関数について説明します。

## [countsymbol]

引数に指定したファイルをfreadして文字数を読み込む

## [buildtree]

カウントの存在する文字についてpopminによって最小カウントの2つを取り出し、それらを統合したノードをcreatenodeで新たに作成する

ここでなぜかは分からないのですが2数の足し算の結果が負の値になることがあり、その場合は最終的に実行時にセグフォとなってしまいます。この謎のエラーの発生割合は自身の体感としては1/3-1/2くらいです。色々考えてみてもどう対応すればよいかわからなかったのでそのまま提出させていただきます。ただし何回か実行すれば必ず正しく出力されるのでご容赦頂けたらと思います。

実行時初めの出力に nodep[1]->count = (整数) というのが出てくるようにしてあるのですが、この値が負の時はこの謎のエラーが発生していることになるのでもう一度実行し直してください。 nodep[1]->count = 139909 となっていれば問題ありません。

## [traversetree]

深さ優先探索を行いツリー構造を出力する関数

ツリー構造をきれいにつなげるためにいくつかの値と配列を用いました。具体的にはtree配列によって枝がつながっているところには'|'が出力されるようにし, linenumberとsuccessiveleftによってtree配列を更新できるようにしました(ある枝が完結したときにそれ以降にそこから枝が伸びないようにする, もしくは枝が伸びないようにしてから再びそこに枝が伸びる必要があるときに'|'を復活させる)。

huffmancodeは左移動で0, 右移動で1が配分されるようにしています。

## [encode]

今まで実装した関数を用いて出力等を実行する関数, 実質のmain関数です

buildtreeで言及した謎のエラーが発生した時に"UNEXPECTED ERROR HAS OCCURRED! RUN THIS PROGRAM AGAIN! もう一度実行してください！"と出力されるようにプログラムを組んだのですが途中でセグフォが生じてしまうため実際には出力されません。traversetreeで大本ができたときにはちゃんと出力されていたのですが最後にツリー構造をきれいにつなげるために微調整していたらセグフォがでるようようになってしまいました…。

bin/huffman news.txt と実行することによって得られるハフマン符号化の結果を以下に示します。

-+- NULL: 0
 |
 +-+-+-+- _: 1000
   | | |
   | | +-+- t: 10010
   | |   |
   | |   +-+-+- p: 1001100
   | |     | |
   | |     | +-+-+- k: 100110100
   | |     |   | |
   | |     |   | +-+-+-+- q: 100110101000
   | |     |   |   | | |
   | |     |   |   | | +- z: 100110101001
   | |     |   |   | |
   | |     |   |   | +- j: 10011010101
   | |     |   |   |
   | |     |   |   +- ': 1001101011
   | |     |   |
   | |     |   +- v: 10011011
   | |     |
   | |     +- l: 100111
   | |
   | +-+-+-+-+- f: 1010000
   |   | | | |
   |   | | | +- g: 1010001
   |   | | |
   |   | | +- d: 101001
   |   | |
   |   | +- a: 10101
   |   |
   |   +-+- n: 10110
   |     |
   |     +- i: 10111
   |
   +-+-+-+- o: 11000
     | | |
     | | +-+- h: 110010
     | |   |
     | |   +- c: 110011
     | |
     | +-+- r: 11010
     |   |
     |   +- s: 11011
     |
     +-+- e: 1110
       |
       +-+-+-+- y: 1111000
         | | |
         | | +-+-+- .: 111100100
         | |   | |
         | |   | +- x: 111100101
         | |   |
         | |   +- \n: 11110011
         | |
         | +-+- b: 1111010
         |   |
         |   +- w: 1111011
         |
         +-+- u: 111110
           |
           +- m: 111111
A tree has been constructed successfully.
